# 日志系统使用说明

## 功能特性

系统已集成完整的日志记录和显示功能，帮助快速定位问题。

## 日志面板

### 位置
右下角有一个**蓝色圆形按钮**（📋），点击可打开/关闭日志面板。

### 功能
- **实时显示**：所有操作都会实时记录日志
- **日志级别**：
  - 🔵 **信息**（蓝色）：普通操作记录
  - 🟢 **成功**（绿色）：操作成功
  - 🟡 **警告**（黄色）：需要注意的情况
  - 🔴 **错误**（红色）：操作失败或异常

- **操作按钮**：
  - **清空**：清除所有日志
  - **关闭**：隐藏日志面板

## 日志记录位置

### 1. API层日志
- 每次API请求前记录：请求方法、URL、参数
- 请求成功：绿色成功日志 + 响应数据
- 请求失败：红色错误日志 + 错误详情

### 2. 股票选择器日志
- 搜索开始：记录搜索关键词
- 搜索结果：记录找到的股票数量
- 选择股票：记录选中的股票代码和名称

### 3. 主页面日志
- 组件挂载：记录初始状态
- 股票选择：记录选择的股票信息
- 日期更改：记录新的日期范围
- 查询操作：
  - 查询前验证（是否选择股票）
  - API调用
  - 数据加载成功/失败
  - 数据条数统计

### 4. K线图组件日志
- 数据接收：记录接收到的数据条数
- 图表初始化
- 图表渲染开始/完成
- 数据范围（起始日期到结束日期）

## 使用方法

### 基本调试流程

1. **打开日志面板**
   - 点击右下角的📋按钮

2. **执行操作**
   - 搜索股票
   - 选择股票
   - 修改日期
   - 点击查询

3. **查看日志**
   - 观察每个操作的日志输出
   - 查找错误信息（红色）
   - 检查数据流转是否正常

4. **定位问题**
   - 如果某个步骤没有日志输出 → 该功能可能没有触发
   - 如果有错误日志 → 查看错误详情定位问题
   - 如果API返回错误 → 检查后端服务状态

## 常见问题排查

### 问题1: 点击查询没反应
**查看日志步骤**：
1. 点击📋打开日志面板
2. 点击"查询"按钮
3. 检查日志：
   - ✅ 有"主页面: 开始获取K线数据" → 功能正常触发
   - ❌ 没有日志 → 按钮事件可能没绑定

### 问题2: 搜索不到股票
**查看日志步骤**：
1. 输入关键词
2. 等待300ms（防抖延迟）
3. 检查日志：
   - 是否有"开始搜索股票"
   - 是否有"API请求: GET /stocks/list"
   - API响应状态码和数据
   - 搜索结果数量

### 问题3: K线图不显示
**查看日志步骤**：
1. 查询数据后
2. 检查日志：
   - API是否返回数据
   - 数据条数是否 > 0
   - "K线图: 渲染图表" 是否出现
   - 是否有渲染错误

## 浏览器控制台

日志同时输出到浏览器控制台（F12），可以看到更详细的信息和堆栈跟踪。

## 日志数据结构

每条日志包含：
- **时间戳**：操作发生的时间
- **级别**：info/success/warning/error
- **消息**：描述性文本
- **数据**（可选）：相关的对象或数组（点击展开查看）

## 示例

### 正常流程的日志输出

```
14:30:15 [信息] 主页面: 组件已挂载
14:30:15 [信息] 主页面: 初始状态 - 股票:未选择, 日期:2025-11-01~2026-01-30
14:30:18 [信息] 开始搜索股票: "600000"
14:30:18 [信息] API请求: GET /stocks/list
14:30:18 [成功] API响应: /stocks/list
14:30:18 [成功] 搜索到 1 只股票
14:30:20 [信息] 选择股票: 600000.SH
14:30:20 [信息] 主页面: 股票已选择 - 600000.SH 浦发银行
14:30:22 [信息] 主页面: 开始获取K线数据
14:30:22 [信息] 主页面: 查询参数 - 股票:600000.SH, 日期:2025-11-01~2026-01-30
14:30:22 [信息] 主页面: 调用API获取K线数据...
14:30:22 [信息] API请求: GET /kline/data
14:30:23 [成功] API响应: /kline/data
14:30:23 [信息] 主页面: API响应
14:30:23 [成功] 主页面: 成功加载 60 个交易日数据
14:30:23 [信息] 主页面: 查询完成
14:30:23 [信息] K线图: 数据更新 - 60 条数据, 股票: 浦发银行 (600000.SH)
14:30:23 [信息] K线图: 渲染图表 - 日期范围 2025-11-01 ~ 2026-01-29
14:30:23 [成功] K线图: 渲染完成
```

## 开发建议

如果需要添加更多日志点，使用：

```typescript
import { logger } from '../../store/useLogStore';

// 在关键位置添加
logger.info('描述信息', { 相关数据 });
logger.success('操作成功', { 结果 });
logger.warning('注意事项', { 详情 });
logger.error('错误描述', { 错误对象 });
```
